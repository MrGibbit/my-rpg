<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Classic-Inspired RPG Prototype</title>
<link rel="icon" href="data:,">
<script>
  (function () {
    if (!/\.github\.io$/i.test(location.hostname)) return;
    var parts = location.pathname.split("/").filter(Boolean);
    if (!parts.length) return;
    var baseEl = document.createElement("base");
    baseEl.href = "/" + parts[0] + "/";
    document.head.appendChild(baseEl);
  })();
</script>

<link rel="stylesheet" href="style.css?v=0.4.3">


</head>

<body>
<div class="wrap">
  <div class="gameArea" id="gameArea">
    <canvas id="c" width="960" height="640"></canvas>

    <!-- HP HUD -->
    <div class="hudTopLeft">
      <div class="hpCard">
        <div class="hpRow">
          <div id="hudName">Adventurer</div>
          <div id="hudHPText">HP 30 / 30</div>
        </div>
      <div class="coordCard">
        <div class="coordRow"><span class="coordKey">P</span><span class="coordVal" id="coordPlayer">0, 0</span></div>
        <div class="coordRow"><span class="coordKey">M</span><span class="coordVal" id="coordMouse">—</span></div>
      </div>

        <div class="hpBar"><div id="hudHPBar"></div></div>
        <div class="hpRow" style="margin-top:8px; font-weight:800; color:rgba(169,183,198,.95);">
          <div id="hudClass">Warrior</div>
          <div style="display:flex; gap:10px; align-items:center;">
  <div id="hudGoldText">Gold: 0</div>
  <div id="hudQuiverText">Quiver: 0</div>
<div id="hudCombatText">Combat: 3</div>

</div>

        </div>
      </div>
    </div>

    <!-- Top-right HUD: minimap + icons -->
    <div class="hudTopRight">
      <div class="iconBar" id="iconBar">
        <button class="iconBtn" id="iconInv" title="Inventory" aria-label="Inventory">
          <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges" aria-hidden="true" focusable="false">
            <rect x="1" y="1" width="14" height="14" rx="2" fill="#26180f"/>
            <rect x="2" y="2" width="12" height="12" rx="1" fill="#4c3422"/>
            <rect x="2" y="2" width="12" height="4" fill="#7b5a3a"/>
            <rect x="2" y="9" width="12" height="5" fill="rgba(0,0,0,.24)"/>
            <rect x="4" y="6" width="8" height="6" rx="1" fill="#9a6737"/>
            <rect x="5" y="7" width="6" height="4" fill="#7c4f27"/>
            <rect x="6" y="4" width="4" height="3" rx="1" fill="#c08b55"/>
            <rect x="7" y="8" width="2" height="2" fill="#f3cf9e"/>
          </svg>
        </button>
        <button class="iconBtn" id="iconEqp" title="Equipment" aria-label="Equipment">
          <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges" aria-hidden="true" focusable="false">
            <rect x="1" y="1" width="14" height="14" rx="2" fill="#161e28"/>
            <rect x="2" y="2" width="12" height="12" rx="1" fill="#2f3d50"/>
            <rect x="2" y="2" width="12" height="4" fill="#536a86"/>
            <rect x="2" y="9" width="12" height="5" fill="rgba(0,0,0,.24)"/>
            <path d="M8 3 L10 5 L9 10 L8 12 L7 10 L6 5 Z" fill="#dbe6f3"/>
            <rect x="7" y="6" width="2" height="1" fill="#f8fafc"/>
            <path d="M4.2 6.2 L5.8 6.9 L5.4 9 L4.2 10.1 L3 9 L2.6 6.9 Z" fill="#7da49e"/>
            <rect x="4" y="7.3" width=".5" height="2.2" fill="#314746"/>
          </svg>
        </button>
        <button class="iconBtn" id="iconSki" title="Skills" aria-label="Skills">
          <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges" aria-hidden="true" focusable="false">
            <rect x="1" y="1" width="14" height="14" rx="2" fill="#1f1530"/>
            <rect x="2" y="2" width="12" height="12" rx="1" fill="#3d2b5b"/>
            <rect x="2" y="2" width="12" height="4" fill="#6a4b9e"/>
            <rect x="2" y="9" width="12" height="5" fill="rgba(0,0,0,.24)"/>
            <path d="M8 3.1 L9.1 6.6 L12.6 8 L9.1 9.4 L8 12.9 L6.9 9.4 L3.4 8 L6.9 6.6 Z" fill="#efe6ff"/>
            <circle cx="8" cy="8" r="1.1" fill="#ffffff"/>
          </svg>
        </button>
        <button class="iconBtn" id="iconBank" title="Bank" aria-label="Bank">
          <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges" aria-hidden="true" focusable="false">
            <rect x="1" y="1" width="14" height="14" rx="2" fill="#29180a"/>
            <rect x="2" y="2" width="12" height="12" rx="1" fill="#4a2c13"/>
            <rect x="2" y="2" width="12" height="4" fill="#7c4d1e"/>
            <rect x="2" y="9" width="12" height="5" fill="rgba(0,0,0,.24)"/>
            <rect x="3.2" y="6" width="9.6" height="6" rx="1" fill="#925e2e"/>
            <rect x="4.1" y="6.8" width="7.8" height="4.3" fill="#7a4a22"/>
            <rect x="7.1" y="8" width="1.8" height="2.6" fill="#facc15"/>
            <rect x="6.7" y="6.2" width="2.6" height=".9" fill="#f1c14d"/>
          </svg>
        </button>
        <button class="iconBtn" id="iconVendor" title="Vendor" aria-label="Vendor">
          <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges" aria-hidden="true" focusable="false">
            <rect x="1" y="1" width="14" height="14" rx="2" fill="#121f22"/>
            <rect x="2" y="2" width="12" height="12" rx="1" fill="#25434a"/>
            <rect x="2" y="2" width="12" height="4" fill="#3f6f79"/>
            <rect x="2" y="9" width="12" height="5" fill="rgba(0,0,0,.24)"/>
            <path d="M3 6 H13 L12 8.4 H4 Z" fill="#f8fafc"/>
            <path d="M4.7 8.5 H11.3 L10.8 10.9 H5.2 Z" fill="#dbeafe"/>
            <circle cx="6.2" cy="12.1" r="1" fill="#f8fafc"/>
            <circle cx="9.8" cy="12.1" r="1" fill="#f8fafc"/>
          </svg>
        </button>
        <button class="iconBtn" id="iconSet" title="Settings" aria-label="Settings">
          <svg width="20" height="20" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges" aria-hidden="true" focusable="false">
            <rect x="1" y="1" width="14" height="14" rx="2" fill="#171b22"/>
            <rect x="2" y="2" width="12" height="12" rx="1" fill="#2d3644"/>
            <rect x="2" y="2" width="12" height="4" fill="#546276"/>
            <rect x="2" y="9" width="12" height="5" fill="rgba(0,0,0,.24)"/>
            <circle cx="8" cy="8" r="2.9" fill="#b8c4d4"/>
            <circle cx="8" cy="8" r="1.3" fill="#39475a"/>
            <rect x="7.6" y="3" width=".8" height="1.5" fill="#d8e2ef"/>
            <rect x="7.6" y="11.5" width=".8" height="1.5" fill="#d8e2ef"/>
            <rect x="11.5" y="7.6" width="1.5" height=".8" fill="#d8e2ef"/>
            <rect x="3" y="7.6" width="1.5" height=".8" fill="#d8e2ef"/>
            <rect x="10.6" y="4.8" width="1.2" height=".8" transform="rotate(45 11.2 5.2)" fill="#d8e2ef"/>
            <rect x="4.2" y="10.4" width="1.2" height=".8" transform="rotate(45 4.8 10.8)" fill="#d8e2ef"/>
            <rect x="10.6" y="10.4" width="1.2" height=".8" transform="rotate(-45 11.2 10.8)" fill="#d8e2ef"/>
            <rect x="4.2" y="4.8" width="1.2" height=".8" transform="rotate(-45 4.8 5.2)" fill="#d8e2ef"/>
          </svg>
        </button>
      </div>

      <div class="minimapFrame">
        <canvas id="minimap" width="150" height="150"></canvas>
      </div>
    </div>

    <!-- Windows -->
    <div class="window hidden" id="winInventory" style="left:18px; top:70px; width:360px; height:420px;">
      <div class="winHeader" id="hdrInventory">
        <div class="title">Inventory <span class="pill" id="invCount">0/28</span> <span class="pill" id="invQuiverPill">Quiver: 0</span> <span class="pill" id="invGoldPill">Gold: 0</span></div>

        <button class="winClose" data-close="inventory" title="Close">X</button>
      </div>
      <div class="winBody">
        <div class="useState">
          <div class="small" id="invUseState">Use: none</div>
          <div class="pill" id="invHintPill">Right-click</div>
        </div>
        <div class="inv" id="invGrid"></div>
        <div class="hint">Arrows are stored in your quiver (no inventory slots). Right-click for Equip / Unequip / Use / Drop.</div>
      </div>
    </div>

    <div class="window hidden" id="winEquipment" style="left:400px; top:70px; width:340px; height:360px;">
      <div class="winHeader" id="hdrEquipment">
        <div class="title">Equipment <span class="pill" id="eqQuiverPill">Quiver: 0</span></div>
        <button class="winClose" data-close="equipment" title="Close">X</button>
      </div>
      <div class="winBody">
        <div class="equipGrid">
          <div class="equipSlot" id="eqWeapon" data-slot="weapon" title="Click to unequip">
            <div class="slotBox" id="eqWeaponIcon">-</div>
            <div class="meta">
              <div class="k">Weapon</div>
              <div class="v" id="eqWeaponName">Empty</div>
            </div>
          </div>

          <div class="equipSlot" id="eqOffhand" data-slot="offhand" title="Click to unequip">
            <div class="slotBox" id="eqOffhandIcon">-</div>
            <div class="meta">
              <div class="k">Offhand</div>
              <div class="v" id="eqOffhandName">Empty</div>
            </div>
          </div>

          <div class="equipSlot equipSlotStatic" id="eqQuiver" title="Arrows in your quiver">
            <div class="slotBox slotBoxStack" id="eqQuiverIcon">-</div>
            <div class="meta">
              <div class="k">Quiver</div>
              <div class="v" id="eqQuiverName">Empty</div>
            </div>
            <div class="equipQty isHidden" id="eqQuiverQty">0</div>
          </div>
        </div>

        <div class="hint">
          Click weapon/offhand to unequip. Right-click Quiver to move arrows to inventory.
        </div>
      </div>
    </div>

        <div class="window hidden" id="winSkills" style="left:18px; top:70px; width:650px; height:600px;">



      <div class="winHeader" id="hdrSkills">
        <div class="title">Skills <span class="pill" id="skillsCombatPill">Combat: 3</span></div>

        <button class="winClose" data-close="skills" title="Close">X</button>
      </div>
      <div class="winBody">
        <div class="seg" id="meleeTrainingSeg">
          <div class="segLabel">Melee Training</div>
          <button class="segBtn" data-melee="accuracy">Accuracy</button>
          <button class="segBtn" data-melee="power">Power</button>
          <button class="segBtn" data-melee="defense">Defense</button>
        </div>

        <div class="skillsGrid" id="skillsGrid"></div>

        <div class="hint">
          Fast leveling is enabled for testing. Melee damage XP goes to exactly one selected skill above.
        </div>
      </div>
    </div>
    <div class="window hidden" id="winBank" style="left:760px; top:70px; width:520px; height:520px;">
      <div class="winHeader" id="hdrBank">
        <div class="title">Bank <span class="pill" id="bankCount">0/56</span></div>
        <button class="winClose" data-close="bank" title="Close">X</button>
      </div>

      <div class="winBody">
        <div class="btnrow">
          <button id="bankDepositAll">Deposit All</button>
          <button id="bankWithdrawAll">Withdraw All</button>
          <div class="pill" id="bankHint">Click inv to deposit, click bank to withdraw</div>
        </div>

        <div class="inv" id="bankGrid" style="grid-template-columns:repeat(7, 1fr);"></div>

        <div class="hint">
          Bank stacks where allowed. Inventory only stacks ammo (but arrows are stored in quiver).
        </div>
      </div>
    </div>

    <div class="window hidden" id="winVendor" style="left:760px; top:120px; width:520px; height:520px;">
      <div class="winHeader" id="hdrVendor">
        <div class="title">Vendor <span class="pill" id="vendorGoldPill">Gold: 0</span></div>
        <button class="winClose" data-close="vendor" title="Close">X</button>
      </div>

      <div class="winBody">
        <div class="btnrow" style="justify-content:space-between;">
          <div class="seg">
            <button class="segBtn active" id="vendorTabBuyBtn" type="button">Buy</button>
            <button class="segBtn" id="vendorTabSellBtn" type="button">Sell</button>
          </div>
          <div class="pill" id="vendorHintPill">Stand next to the vendor to trade</div>
        </div>

        <div class="shopPane" id="vendorList"></div>

        <div class="hint">
          Buy items from the vendor, or sell your items for gold.
        </div>
      </div>
    </div>

    <div class="window hidden" id="winSmithing" style="left:760px; top:120px; width:520px; height:520px;">
      <div class="winHeader" id="hdrSmithing">
        <div class="title">Smithing <span class="pill" id="smithingLevelPill">Smithing Lv 1</span></div>
        <button class="winClose" data-close="smithing" title="Close">X</button>
      </div>

      <div class="winBody">
        <div class="shopPane" id="smithingList"></div>
        <div class="hint">
          Recipes are shown for bar types currently in your inventory. Use the furnace to smelt bars first.
        </div>
      </div>
    </div>

    <div class="window hidden" id="winShop">
      <div class="winHeader">
        <div class="winTitle">Shop</div>
        <button class="xbtn" id="btnShopClose">X</button>
      </div>

      <div class="shopTop">
        <div class="stat"><b>Gold:</b> <span id="shopGold">0</span></div>
        <div class="shopTabs">
          <button class="tabbtn active" id="shopTabBuy">Buy</button>
          <button class="tabbtn" id="shopTabSell">Sell</button>
        </div>
      </div>

      <div class="shopList" id="shopList"></div>
      <div class="small muted" id="shopHint">Stock refreshes periodically.</div>
    </div>

    <div class="window hidden" id="winSettings" style="left:760px; top:600px; width:360px; height:300px;">
      <div class="winHeader" id="hdrSettings">
        <div class="title">Settings</div>
        <button class="winClose" data-close="settings" title="Close">X</button>
      </div>
      <div class="winBody">
        <div class="btnrow">
          <button id="saveBtn">Save</button>
          <button id="loadBtn">Load</button>
          <button id="resetBtn">Reset Save</button>
        </div>

        <div class="btnrow">
          <button id="newCharBtn">New Character</button>
          <button id="deleteCharBtn">Delete Character</button>
        </div>
<div class="small" style="margin-top:6px;">Audio</div>

<div class="settingRow">
  <label class="chk">
    <input type="checkbox" id="musicToggle">
    Music
  </label>

  <input id="musicVol" type="range" min="0" max="100" step="1" value="25" />
  <span class="pill" id="musicVolLabel">25%</span>
</div>

        <div class="hint">
          Mouse wheel: scroll down zooms out, scroll up zooms in. Minimap click moves.
        </div>
      </div>
    </div>

       <!-- Chat HUD -->
    <div class="hudChat" id="hudChat">
      <button class="hudChatTab" id="hudChatTab" type="button">Chat</button>

      <div class="hudChatCard" id="hudChatCard">
        <div class="hudChatHeader" id="hudChatHeader">
          <div style="font-weight:900;">Chat</div>
          <div class="hudChatHeaderRight">
            <button class="hudChatMin" id="hudChatMin" type="button" title="Minimize chat">▁</button>
          </div>
        </div>

        <div class="hudChatBody" id="hudChatBody">
          <div class="chatLog" id="chatLog"></div>

          <div class="chatInputRow">
            <input id="chatInput" class="chatInput" placeholder="Type (for future dialogue / commands)…" />
            <button id="chatSend">Send</button>
          </div>
        </div>

        <div class="hudChatResize" id="hudChatResize" title="Resize chat"></div>
      </div>
    </div>

    <!-- Start overlay -->
    <div id="startOverlay" class="overlay" style="display:none;">
      <div class="modal startModal">
        <h2>Choose Your Adventure</h2>
        <p class="sub">Pick an existing save, continue with your character, or begin a fresh run.</p>

        <div class="startGrid">
          <section class="startCard">
            <div class="startHead">
              <h3>Save Slot</h3>
              <span class="pill" id="startSaveStatus">No Save</span>
            </div>
            <p class="small" id="startSaveMeta">No save data found yet.</p>
          </section>

          <section class="startCard">
            <div class="startHead">
              <h3>Character</h3>
              <span class="pill" id="startCharStatus">No Character</span>
            </div>
            <p class="small" id="startCharMeta">Create a character to start a new game.</p>
          </section>
        </div>

        <div class="btnrow startActions">
          <button id="startContinueBtn">Continue Save</button>
          <button id="startNewGameBtn">New Game</button>
          <button id="startNewCharacterBtn">New Character</button>
        </div>

        <div class="hint">
          Continue loads your last manual save. New Game starts fresh with your selected character.
        </div>
      </div>
    </div>

    <!-- Character creation overlay -->
    <div id="charOverlay" class="overlay" style="display:none;">
      <div class="modal">
        <h2>Character Creation</h2>
        <p class="sub">Pick a class (sets your color and starting gear).</p>

        <div class="formRow">
          <label for="charName">Name</label>
          <input id="charName" type="text" maxlength="14" placeholder="Adventurer" />
        </div>

        <div class="formRow">
          <label>Class</label>
          <div class="classPick" id="classPick">
            <button type="button" class="classBtn" data-class="Warrior">Warrior</button>
            <button type="button" class="classBtn" data-class="Ranger">Ranger</button>
            <button type="button" class="classBtn" data-class="Mage">Wizard/Mage</button>
          </div>
        </div>

        <div class="formRow">
          <label>Color</label>
          <div class="pill" id="charColorPill">—</div>
        </div>

        <div class="btnrow" style="margin-top:12px;">
          <button id="charStart">Enter World</button>
        </div>

        <div class="hint">
          Ranger bow + Mage Air Bolt max range: 5 tiles. Mage casts Air Bolt for free. <br>
          Bank chest is inside the starting castle. Vendor is in the shop east of the castle. <br>
          Rat training packs are south of the river.
        </div>
      </div>
    </div>

    <!-- Load Character -->
    <div id="loadCharOverlay" class="overlay" style="display:none;">
      <div class="modal startModal">
        <h2>Load Character</h2>
        <p class="sub">Choose which character save to load.</p>

        <div id="loadCharList" class="loadCharList"></div>
        <p id="loadCharEmpty" class="small" style="display:none;">No character saves found.</p>

        <div class="btnrow" style="margin-top:12px;">
          <button id="loadCharCancel">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Delete Character confirmation -->
    <div id="deleteCharOverlay" class="overlay" style="display:none;">
      <div class="modal">
        <h2>Delete Character</h2>
        <p class="sub">This will permanently delete your current character. Continue?</p>
        <div class="btnrow" style="margin-top:12px;">
          <button id="deleteCharCancel">Cancel</button>
          <button id="deleteCharConfirm">Delete</button>
        </div>
      </div>
    </div>

  </div>
</div>
<audio id="bgm" src="assets/bgm.mp3" loop preload="auto"></audio>

<script type="module" src="game.js?v=0.4.7"></script>


</body>
</html>
